[32m2026-01-06 12:03:08 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - b31c05d2-ee5a-4ec0-9ce3-fa2ff4cef656 - 1897483 - LOGS_CAPTURED - Started capturing logs in process (pid: 1897483).
[32m2026-01-06 12:03:08 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - b31c05d2-ee5a-4ec0-9ce3-fa2ff4cef656 - 1897483 - nuclear_labels - STEP_START - Started execution of step "nuclear_labels".
[32m2026-01-06 12:03:08 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - b31c05d2-ee5a-4ec0-9ce3-fa2ff4cef656 - nuclear_labels - Loading 1 partitions...
[32m2026-01-06 12:03:08 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - b31c05d2-ee5a-4ec0-9ce3-fa2ff4cef656 - nuclear_labels - Loading partition BR00115126_A01_F001 from /home/vipink/Documents/dagster_imaging_workflow/preprocess_workflow/dagster_img_preprocess/.tmp_dagster_home_h3jglr7u/storage/nuclear_mask/BR00115126_A01_F001 using PickledObjectFilesystemIOManager...
[32m2026-01-06 12:03:08 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - b31c05d2-ee5a-4ec0-9ce3-fa2ff4cef656 - 1897483 - nuclear_labels - LOADED_INPUT - Loaded input "nuclear_mask" using input manager "io_manager", from output "result" of step "nuclear_mask"
[32m2026-01-06 12:03:08 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - b31c05d2-ee5a-4ec0-9ce3-fa2ff4cef656 - 1897483 - nuclear_labels - STEP_INPUT - Got input "nuclear_mask" of type "ndarray". (Type check passed).
[32m2026-01-06 12:03:12 +0100[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - b31c05d2-ee5a-4ec0-9ce3-fa2ff4cef656 - 1897483 - nuclear_labels - STEP_FAILURE - Execution of step "nuclear_labels" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "nuclear_labels"::

AttributeError: 'OnDiskArrayResource' object has no attribute 'base_path'

Stack Trace:
  File "/home/vipink/Documents/dagster_imaging_workflow/preprocess_workflow/.pixi/envs/default/lib/python3.12/site-packages/dagster/_core/execution/plan/utils.py", line 57, in op_execution_error_boundary
    yield
  File "/home/vipink/Documents/dagster_imaging_workflow/preprocess_workflow/.pixi/envs/default/lib/python3.12/site-packages/dagster/_utils/__init__.py", line 394, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/home/vipink/Documents/dagster_imaging_workflow/preprocess_workflow/.pixi/envs/default/lib/python3.12/site-packages/dagster/_core/execution/plan/compute_generator.py", line 135, in _coerce_op_compute_fn_to_iterator
    result = invoke_compute_fn(
             ^^^^^^^^^^^^^^^^^^
  File "/home/vipink/Documents/dagster_imaging_workflow/preprocess_workflow/.pixi/envs/default/lib/python3.12/site-packages/dagster/_core/execution/plan/compute_generator.py", line 115, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vipink/Documents/dagster_imaging_workflow/preprocess_workflow/dagster_img_preprocess/src/dagster_img_preprocess/defs/assets/generate_cell_object.py", line 57, in nuclear_labels
    nuclear_segmentation_file = array_ressource.save_array(nuclear_labels,'nuclear_segmentation',fov_id)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vipink/Documents/dagster_imaging_workflow/preprocess_workflow/dagster_img_preprocess/src/dagster_img_preprocess/defs/resources.py", line 77, in save_array
    file_path = f"{self.base_path}/processed/{img_op}/{fov_id}.h5"
                   ^^^^^^^^^^^^^^
  File "/home/vipink/Documents/dagster_imaging_workflow/preprocess_workflow/.pixi/envs/default/lib/python3.12/site-packages/pydantic/main.py", line 1026, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
[0m
